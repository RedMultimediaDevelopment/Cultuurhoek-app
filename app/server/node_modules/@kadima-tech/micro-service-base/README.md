# Micro Service Base

This package provides an opinionated way of setting up a new micro service. It abstracts away
most required boilerplate code for setting up a service, but exposes most of its internal functionality to enable the developer to fully handle this process in their own way as well.

This package replaces micro-middlewares and micro-healthcheck.

## Configuration

The package makes use of `@standinworks/micro-config-manager` for most of its internal configuration. Whilst sensible defaults are provided, the below table highlights the variables that can be used to override these defaults:

| Environment Variable  | Default Value | Type                              | Description                                                                                                                            |
| --------------------- | ------------- | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| HOSTNAME              | localhost     | string                            | The hostname on which the service is reachable from Kong                                                                               |
| PORT                  | 4000          | number                            | The port on which this service will run                                                                                                |
| LOG_LEVEL             | info          | string [info\|debug\|error\|warn] | The log level the generic logger logs at                                                                                               |
| HTTP_LOG_LEVEL        | warn          | string [info\|debug\|error\|warn] | The log level on the fastify logger logs http requests                                                                                 |
| VERSION               | notset        | string                            | The version of the micro service (configured automatically on the cloud)                                                               |
| GOOGLE_PUBSUB_ENABLED | 0             | number [0\|1]                     | If set to 1 the service will setup PubSub messaging on the specified GCP_PROJECT_ID                                                    |
| REDIS_PUBSUB_ENABLED  | 0             | number [0\|1]                     | If set to 1 the service will setup PubSub messaging with Redis. Will be overridden by GOOGLE_PUBSUB_ENABLED                            |
| GCP_PROJECT_ID        | <no_default>  | string                            | The Google Cloud project that the pubsub bus is hosted on                                                                              |
| REDIS_HOST            | localhost     | string                            | The Redis hostname                                                                                                                     |
| REDIS_PORT            | 6379          | number                            | The Redis port that is used to connect to the redis instance                                                                           |
| PRODUCTION_MODE       | 0             | number                            | Only set to 1 if this instance is running in the cloud. This will be replaced by automatic detection and should never be used locally. |
